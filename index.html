<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MEIN KALENDAR</title>

  <!-- Spartan Font -->
  <link href="https://fonts.googleapis.com/css2?family=Spartan:wght@300;400;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bordeaux: #800020;
      --bordeaux-strong:#6b0018;
      --white:#ffffff;
      --black:#000000;
      --glass: rgba(255,255,255,0.10);
      --glass-dark: rgba(0,0,0,0.45);
      --radius: 12px;
      --shadow: 0 6px 20px rgba(0,0,0,0.18);
      --accent-trans: rgba(128,0,32,0.18);
    }

    [data-theme="dark"] {
      --bg: var(--black);
      --panel: var(--glass-dark);
      --text: #fff;
    }

    [data-theme="light"] {
      --bg: #f7f7f7;
      --panel: rgba(255,255,255,0.6);
      --text: #111;
    }

    html,body{
      height:100%;
      margin:0;
      padding:0;
      font-family: 'Spartan', system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    body{
      background: url('hintergrund.jpg') center/cover no-repeat fixed;
      background-color: var(--bg, #f7f7f7);
      color: var(--text, #111);
      display:flex;
      flex-direction:column;
      align-items:center;
      min-height:100vh;
      transition: background-color .25s ease;
    }

    .app {
      width:95%;
      max-width:980px;
      margin-top:20px;
      margin-bottom:40px;
      display:grid;
      grid-template-columns: 1fr 360px;
      gap:18px;
    }

    header.app-header {
      grid-column: 1/3;
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:14px;
      background:var(--panel);
      border-radius:14px;
      box-shadow:var(--shadow);
      border: 1px solid rgba(255,255,255,0.06);
      backdrop-filter: blur(6px);
      position: relative;
    }

    header .title {
      font-size:18px;
      font-weight:700;
      letter-spacing:1px;
      color:var(--text);
      display:flex;
      align-items:center;
      gap:8px;
    }

    .google-import {
      display:flex;
      align-items:center;
      font-size:10px;
      color:rgba(255,255,255,0.5);
      cursor:pointer;
      gap:4px;
    }

    .google-import:hover { color: rgba(255,255,255,0.8); }

    .controls {
      display:flex;
      gap:10px;
      align-items:center;
    }

    .control-btn {
      background: transparent;
      border: 1px solid rgba(255,255,255,0.08);
      padding:8px 12px;
      border-radius:10px;
      color:var(--text);
      cursor:pointer;
      font-weight:600;
    }

    .calendar-card {
      background:var(--panel);
      border-radius:14px;
      padding:14px;
      box-shadow:var(--shadow);
      min-height:420px;
      display:flex;
      flex-direction:column;
      gap:12px;
      border: 1px solid rgba(0,0,0,0.04);
    }

    .month-header {
      display:flex;
      justify-content:space-between;
      align-items:center;
    }

    .month-title {
      font-size:18px;
      font-weight:700;
      color:var(--text);
    }

    .nav-btn {
      background:transparent;
      border-radius:10px;
      border:1px solid rgba(255,255,255,0.06);
      padding:6px 10px;
      cursor:pointer;
      color:var(--text);
    }

    .calendar-grid {
      display:grid;
      grid-template-columns: repeat(7,1fr);
      gap:8px;
    }

    .day {
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:10px;
      padding:8px;
      min-height:90px;
      position:relative;
      border: 1px solid rgba(255,255,255,0.06);
      color:var(--text);
      display:flex;
      flex-direction:column;
      gap:4px;
      transition: transform .12s ease;
    }

    .day:hover { transform: translateY(-3px); }

    .day .date-num {
      font-size:13px;
      font-weight:700;
      display:flex;
      flex-direction:column;
      align-items:flex-start;
    }

    .day .date-num span {
      font-size:9px;
      font-weight:400;
      margin-top:2px;
    }

    .event-pill {
      margin-top:auto;
      padding:6px 8px;
      border-radius:10px;
      font-size:12px;
      background: rgba(255,255,255,0.06);
      color:var(--text);
      border-left:6px solid rgba(255,255,255,0.08);
      display:flex;
      justify-content:space-between;
      gap:8px;
      align-items:center;
    }

    .type-default { border-left-color: rgba(255,255,255,0.08); }
    .type-private { border-left-color: #d32f2f; }
    .type-work    { border-left-color: #2e7d32; }

    .side-card {
      background:var(--panel);
      border-radius:14px;
      padding:12px;
      box-shadow:var(--shadow);
      display:flex;
      flex-direction:column;
      gap:12px;
    }

    .input-row {
      display:flex;
      gap:8px;
      align-items:center;
    }

    .input-row input[type="text"]{
      flex:1;
      padding:10px 12px;
      border-radius:10px;
      border: none;
      outline:none;
      background: rgba(255,255,255,0.03);
      color:var(--text);
      font-weight:600;
    }

    .small-select {
      padding:8px 10px;
      background: transparent;
      border-radius:10px;
      border:1px solid rgba(255,255,255,0.06);
      color:var(--text);
      font-weight:600;
    }

    .icon-btn {
      padding:8px 10px;
      border-radius:10px;
      background:var(--bordeaux);
      color:var(--white);
      border:none;
      cursor:pointer;
      font-weight:700;
    }

    .weeks-list {
      display:flex;
      flex-direction:column;
      gap:8px;
      max-height:420px;
      overflow:auto;
    }

    .week-item {
      border-radius:10px;
      padding:10px;
      background: rgba(255,255,255,0.02);
      display:flex;
      flex-direction:column;
      gap:8px;
      border:1px solid rgba(255,255,255,0.03);
    }

    .week-title {
      font-weight:700;
      color:var(--text);
      display:flex;
      justify-content:space-between;
      align-items:center;
    }

    .event-row {
      display:flex;
      justify-content:space-between;
      gap:10px;
      padding:6px 8px;
      border-radius:8px;
      background: rgba(255,255,255,0.01);
      align-items:center;
      border-left: 6px solid rgba(255,255,255,0.03);
    }

    .event-row.private { border-left-color: #d32f2f; }
    .event-row.work    { border-left-color: #2e7d32; }
    .event-row.default { border-left-color: rgba(255,255,255,0.06); }

    .tiny-muted { font-size:12px; opacity:0.7; }

    @media (max-width:980px){
      .app { grid-template-columns: 1fr; }
    }

    @media (max-width:600px){
      .calendar-grid { grid-template-columns: repeat(auto-fit,minmax(60px,1fr)); gap:4px; }
      .day { min-height:70px; padding:4px; font-size:11px; }
      .date-num { font-size:10px; }
      .day .date-num span { font-size:8px; }
    }
  </style>
</head>
<body data-theme="light">

  <div class="app">
    <header class="app-header">
      <div class="title">
        MEIN KALENDAR
        <div class="google-import" id="googleImportBtn">
          ðŸ“… <span>An dein Google Kalender importieren</span>
        </div>
      </div>
      <div class="controls">
        <button id="themeToggle" class="control-btn">ðŸŒ™ / â˜€</button>
        <button id="pushToggle" class="control-btn">ðŸ””</button>
      </div>
    </header>

    <section class="calendar-card" id="calendarCard">
      <div class="month-header">
        <button class="nav-btn" id="prevMonth">â—€</button>
        <div class="month-title" id="monthTitle">Oktober 2025</div>
        <button class="nav-btn" id="nextMonth">â–¶</button>
      </div>

      <div class="calendar-grid" id="calendarGrid"></div>
    </section>

    <aside class="side-card">
      <div>
        <div class="input-row">
          <input id="freeInput" type="text" placeholder="z.B. Jeden Montag laufen im nÃ¤chsten Monat">
          <select id="typeSelect" class="small-select">
            <option value="default">Standard</option>
            <option value="private">Privat</option>
            <option value="work">Arbeit</option>
          </select>
          <button id="micBtn" class="icon-btn" title="Sprache (spÃ¤ter) ðŸŽ™">ðŸŽ™</button>
        </div>
        <div style="display:flex;gap:8px;margin-top:8px;">
          <button id="addEventBtn" class="icon-btn" style="background:var(--bordeaux)">+</button>
          <button id="clearBtn" class="control-btn">Clear</button>
        </div>
      </div>

      <div>
        <div style="font-weight:700;margin-bottom:8px;">Kommende Wochen</div>
        <div class="weeks-list" id="weeksList"></div>
      </div>
    </aside>
  </div>

<script>
const calendarGrid = document.getElementById("calendarGrid");
const monthTitle = document.getElementById("monthTitle");
const prevMonthBtn = document.getElementById("prevMonth");
const nextMonthBtn = document.getElementById("nextMonth");
const addEventBtn = document.getElementById("addEventBtn");
const freeInput = document.getElementById("freeInput");
const typeSelect = document.getElementById("typeSelect");
const weeksList = document.getElementById("weeksList");
const googleImportBtn = document.getElementById("googleImportBtn");

let currentDate = new Date();
let events = []; // Alle Events speichern

function renderCalendar(date){
    calendarGrid.innerHTML = "";
    const year = date.getFullYear();
    const month = date.getMonth();
    const firstDay = new Date(year, month, 1);
    const lastDay = new Date(year, month + 1, 0);
    const startDay = firstDay.getDay() === 0 ? 7 : firstDay.getDay(); // Sonntag=7
    const daysInMonth = lastDay.getDate();

    monthTitle.textContent = `${firstDay.toLocaleString('de-DE',{month:'long'})} ${year}`;

    // Platzhalter fÃ¼r Tage vor Monatsanfang
    for(let i=1; i<startDay; i++){
        const emptyCell = document.createElement("div");
        emptyCell.className="day";
        calendarGrid.appendChild(emptyCell);
    }

    // Tage
    for(let d=1; d<=daysInMonth; d++){
        const dayDiv = document.createElement("div");
        dayDiv.className="day";
        const dayDate = new Date(year, month, d);
        const weekdayName = dayDate.toLocaleDateString('de-DE',{weekday:'short'});
        dayDiv.innerHTML = `<div class="date-num">${d}<span>${weekdayName}</span></div>`;
        
        const dayEvents = events.filter(e => e.date.toDateString() === dayDate.toDateString());
        dayEvents.forEach(ev=>{
            const pill = document.createElement("div");
            pill.className=`event-pill type-${ev.type}`;
            pill.textContent = ev.title;
            dayDiv.appendChild(pill);
        });

        calendarGrid.appendChild(dayDiv);
    }
}

function addEvent(title,type,date){
    events.push({title,type,date});
    renderCalendar(currentDate);
    renderWeeksList();
}

// Wochenliste rendern
function renderWeeksList(){
    weeksList.innerHTML="";
    const sorted = events.sort((a,b)=>a.date-b.date);
    sorted.forEach(ev=>{
        const item = document.createElement("div");
        item.className=`week-item`;
        item.innerHTML=`<div class="week-title">${ev.date.toLocaleDateString('de-DE',{weekday:'long',day:'numeric',month:'numeric'})} <span class="tiny-muted">${ev.title}</span></div>`;
        weeksList.appendChild(item);
    });
}

// Hilfsfunktionen fÃ¼r Datum
function nextWeekday(weekday, fromDate=new Date()){
    const days = ['sonntag','montag','dienstag','mittwoch','donnerstag','freitag','samstag'];
    const wd = days.indexOf(weekday.toLowerCase());
    if(wd===-1) return null;
    let d = new Date(fromDate);
    let diff = (wd + 7 - d.getDay()) % 7;
    if(diff===0) diff=7;
    d.setDate(d.getDate() + diff);
    return d;
}

function getAllWeekdaysInMonth(weekday,monthDate){
    const days = [];
    const firstDay = new Date(monthDate.getFullYear(), monthDate.getMonth(),1);
    const lastDay = new Date(monthDate.getFullYear(), monthDate.getMonth()+1,0);
    for(let d=1; d<=lastDay.getDate(); d++){
        const date = new Date(monthDate.getFullYear(), monthDate.getMonth(),d);
        if(date.toLocaleDateString('de-DE',{weekday:'long'}).toLowerCase().startsWith(weekday.toLowerCase())){
            days.push(date);
        }
    }
    return days;
}

function parseInput(input){
    input = input.toLowerCase();
    const type = typeSelect.value;
    const today = new Date();

    // "jeden [Wochentag]"
    let match = input.match(/jeden\s+(\w+)/);
    if(match){
        let weekday = match[1];
        if(input.includes("nÃ¤chsten monat")){
            const nextMonth = new Date(today.getFullYear(), today.getMonth()+1,1);
            const days = getAllWeekdaysInMonth(weekday,nextMonth);
            days.forEach(d=>addEvent(input,type,d));
        } else {
            // Aktueller Monat
            const thisMonth = new Date(today.getFullYear(), today.getMonth(),1);
            const days = getAllWeekdaysInMonth(weekday,thisMonth);
            days.forEach(d=>addEvent(input,type,d));
        }
        return;
    }

    // "am [Wochentag]"
    match = input.match(/am\s+(\w+)/);
    if(match){
        const weekday = match[1];
        const d = nextWeekday(weekday);
        addEvent(input,type,d);
        return;
    }

    // "Ã¼bermorgen", "morgen", "heute"
    if(input.includes("Ã¼bermorgen")){addEvent(input,type,new Date(today.getFullYear(),today.getMonth(),today.getDate()+2));return;}
    if(input.includes("morgen")){addEvent(input,type,new Date(today.getFullYear(),today.getMonth(),today.getDate()+1));return;}
    if(input.includes("heute")){addEvent(input,type,new Date(today.getFullYear(),today.getMonth(),today.getDate()));return;}

    // "nÃ¤chster [Wochentag]"
    match = input.match(/nÃ¤chsten\s+(\w+)/);
    if(match){
        const weekday = match[1];
        const d = nextWeekday(weekday);
        addEvent(input,type,d);
        return;
    }

    // "die ganze woche" oder "in der woche" (werktage)
    if(input.includes("die ganze woche") || input.includes("in der woche") || input.includes("alle werktage")){
        const start = new Date(today);
        start.setDate(start.getDate() - start.getDay() + 1); // Montag
        for(let i=0;i<5;i++){
            const d = new Date(start.getFullYear(),start.getMonth(),start.getDate()+i);
            addEvent(input,type,d);
        }
        return;
    }

    // "am wochenende"
    if(input.includes("am wochenende")){
        const saturday = nextWeekday("samstag");
        const sunday = nextWeekday("sonntag");
        addEvent(input,type,saturday);
        addEvent(input,type,sunday);
        return;
    }

    // Wenn nur Wochentag ohne "am" oder "jeden"
    match = input.match(/^(montag|dienstag|mittwoch|donnerstag|freitag|samstag|sonntag)\b/);
    if(match){
        const d = nextWeekday(match[0]);
        addEvent(input,type,d);
        return;
    }

    // Default: heute
    addEvent(input,type,today);
}

// Event hinzufÃ¼gen
addEventBtn.addEventListener("click",()=>{
    if(freeInput.value.trim()!==""){
        parseInput(freeInput.value.trim());
        freeInput.value="";
    }
});

// Google Calendar Import
googleImportBtn.addEventListener("click",()=>{
    if(events.length===0) return;
    let baseUrl = "https://www.google.com/calendar/render?action=TEMPLATE";
    let fullUrl = baseUrl;
    // Einfach alle Events hintereinander mit &text=Title&dates=YYYYMMDDTHHMMSSZ/YYYYMMDDTHHMMSSZ
    // FÃ¼r Demo, nur Datum heute mittags
    events.forEach(ev=>{
        const y = ev.date.getFullYear();
        const m = String(ev.date.getMonth()+1).padStart(2,'0');
        const d = String(ev.date.getDate()).padStart(2,'0');
        const start = `${y}${m}${d}T120000Z`;
        const end = `${y}${m}${d}T130000Z`;
        fullUrl += `&text=${encodeURIComponent(ev.title)}&dates=${start}/${end}`;
    });
    window.open(fullUrl,"_blank");
});

// Navigation
prevMonthBtn.addEventListener("click",()=>{ currentDate.setMonth(currentDate.getMonth()-1); renderCalendar(currentDate); });
nextMonthBtn.addEventListener("click",()=>{ currentDate.setMonth(currentDate.getMonth()+1); renderCalendar(currentDate); });

// Initial render
renderCalendar(currentDate);

</script>
</body>
</html>

